{%- style -%}
  .category-list__grid {
    display: grid;
    grid-template-columns: repeat({{ section.settings.columns_desktop }}, 1fr);
    gap: {{ section.settings.grid_gap }}px;
    width: 100vw;
    max-width: 100vw;
    margin-left: 50%;
    transform: translateX(-50%);
  }
  @media screen and (max-width: 749px) {
    .category-list__grid {
      grid-template-columns: repeat({{ section.settings.columns_mobile }}, 1fr);
    }
  }
  .category-list__item {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: stretch;
    position: relative;
    background: #fff;
  }
  .category-list__image-wrapper {
    width: 100%;
    aspect-ratio: 3/4;
    overflow: hidden;
    background: #f7f7f7;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .category-list__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  .category-list__caption {
    padding: 1.5rem 0 1.5rem 0;
    text-align: center;
    background: #fff;
  }
  .category-list__title {
    margin: 0 0 0.5rem 0;
    font-size: {{ section.settings.font_size }}px;
    font-weight: {{ section.settings.font_weight }};
    {% if section.settings.uppercase %}text-transform: uppercase; letter-spacing: 0.08em;{% endif %}
  }
  .category-list__link {
    font-size: 1.1rem;
    color: #222;
    text-decoration: underline;
    letter-spacing: 0.05em;
    font-weight: 400;
    display: inline-block;
    margin-top: 0.2rem;
  }
{%- endstyle -%}

<div class="category-list__grid">
  {%- for block in section.blocks -%}
    {%- assign collection = collections[block.settings.collection] -%}
    <div class="category-list__item" {{ block.shopify_attributes }}>
      <a href="{{ block.settings.link | default: collection.url }}" class="category-list__image-wrapper">
        {%- if block.settings.image != blank -%}
          <img
            src="{{ block.settings.image | image_url: width: 800 }}"
            alt="{{ block.settings.title | escape }}"
            class="category-list__image"
            loading="lazy"
            width="800"
            height="1067"
          >
        {%- elsif collection.image != blank -%}
          <img
            src="{{ collection.image | image_url: width: 800 }}"
            alt="{{ block.settings.title | escape }}"
            class="category-list__image"
            loading="lazy"
            width="800"
            height="1067"
          >
        {%- else -%}
          {{ 'collection-1' | placeholder_svg_tag: 'category-list__image' }}
        {%- endif -%}
      </a>
      <div class="category-list__caption">
        <div
          class="category-list__title"
          style="font-size: {{ block.settings.font_size | default: section.settings.font_size }}px; font-weight: {{ block.settings.font_weight | default: section.settings.font_weight }};{% if block.settings.uppercase or section.settings.uppercase %} text-transform: uppercase; letter-spacing: 0.08em;{% endif %}"
        >
          {{ block.settings.title | default: collection.title }}
        </div>
        {%- if block.settings.link_label != blank -%}
          <a href="{{ block.settings.link | default: collection.url }}" class="category-list__link">
            {{- block.settings.link_label -}}
          </a>
        {%- endif -%}
      </div>
    </div>
  {%- endfor -%}
</div>

{% schema %}
{
  "name": "Category List Skims Style",
  "tag": "section",
  "class": "section section-collection-grid",
  "settings": [
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Columns on desktop"
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2,
      "label": "Columns on mobile"
    },
    {
      "type": "range",
      "id": "grid_gap",
      "min": 0,
      "max": 40,
      "step": 1,
      "default": 0,
      "label": "Gap between images (px)"
    },
    {
      "type": "range",
      "id": "font_size",
      "min": 12,
      "max": 40,
      "step": 1,
      "default": 18,
      "label": "Category name font size (px)"
    },
    {
      "type": "select",
      "id": "font_weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "600", "label": "Semi Bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "700",
      "label": "Category name font weight"
    },
    {
      "type": "checkbox",
      "id": "uppercase",
      "label": "Uppercase category name",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Custom image (optional)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Category name (optional)"
        },
        {
          "type": "range",
          "id": "font_size",
          "min": 12,
          "max": 40,
          "step": 1,
          "default": 0,
          "label": "Font size (override, px)"
        },
        {
          "type": "select",
          "id": "font_weight",
          "options": [
            { "value": "", "label": "Default" },
            { "value": "400", "label": "Regular" },
            { "value": "600", "label": "Semi Bold" },
            { "value": "700", "label": "Bold" }
          ],
          "default": "",
          "label": "Font weight (override)"
        },
        {
          "type": "checkbox",
          "id": "uppercase",
          "label": "Uppercase (override)",
          "default": false
        },
        {
          "type": "text",
          "id": "link_label",
          "label": "Link label (e.g. SHOP NOW)",
          "default": "SHOP NOW"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Custom link (optional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Category List Skims Style",
      "blocks": [{ "type": "category" }, { "type": "category" }, { "type": "category" }, { "type": "category" }]
    }
  ]
}
{% endschema %}
